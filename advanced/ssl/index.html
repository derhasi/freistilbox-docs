<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>freistilbox docs - </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="screen">
  <link href="/style.css" rel="stylesheet" type="text/css" media="screen">
  <link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
  <meta name="generator" content="nanoc 3.6.1"> 
</head>
<body>

  <div class="container-fluid">
    <div class="row-fluid">

      <div class="span2">
        <div id="sidebar">
          <ul>
            <li><a href="/">Home</a></li>
          </ul>
          <h2>Main sections</h2>
          <ul>
            <li><a href="/basics/">freistilbox Basics</a></li>
            <li><a href="/start/">Getting Started</a></li>
            <li><a href="/advanced/">Advanced Usage</a></li>
          </ul>
          <h2>External links</h2>
          <ul>
            <li><a href="http://support.freistil.it">Help Center</a></li>
            <li><a href="https://freistil.zendesk.com/forums/21512451-FAQ">FAQ</a></li>
            <li><a href="http://www.freistilbox.com/">freistilbox</a></li>
            <li><a href="http://www.freistil.it/">freistil IT</a></li>
          </ul>
        </div>
      </div>

      <div class="span10">
        <div id="main">
          <ul class="breadcrumb">
            
            
            <li><a href="/">Home</a></li> <span class="divider">/</span>
            
            <li><a href="/advanced/">Advanced Usage</a></li> <span class="divider">/</span>
            
            <li class="active"></li>
          </ul>
          <div id="content">
            <h1 id="ssl-encryption">SSL encryption</h1>

<h2 id="ssl-offloading">SSL offloading</h2>

<p>If you need SSL encryption for your website, freistilbox has a great feature for you: SSL offloading. This means that SSL packets are decrypted the moment they reach the freistilbox infrastructure. The HTTP requests that were encrypted in the SSL packets are then passed on to the next system layers. This has several advantages:</p>

<ul>
  <li>HTTP caching works regardless of encryption. That way, you don’t need to use “mixed mode” (i.e. delivering parts of a page unencrypted) to achieve short delivery times for page assets.</li>
  <li>Your web application servers don’t need to use their computing resources for decrypting requests and encrypting their responses.</li>
</ul>

<h2 id="recognizing-secure-requests">Recognizing secure requests</h2>

<p>Because SSL request are decrypted before they reach your freistilboxes, your web application will always receive plain HTTP requests. In order to be able to see if a request originally came in SSL-encrypted, the SSL offloader marks those with the HTTP header “X-Forwarded-Proto” and set its value to “https”. Our web servers then set an environment variable named <code>HTTPS</code> to the value <code>on</code>.</p>

<p>In your application, you can simply test this variable to see if a request had been encrypted by its sender. </p>

<p>In PHP:</p>

<pre><code>if (_SERVER['HTTPS'] == "on")
</code></pre>

<p>This variable is set by PHP for incoming SSL requests, too, so existing applications, plugins and modules should work out of the box.</p>

<p>If you need to test for SSL in an <code>.htaccess</code> file, there’s a catch. While Apache’s <code>mod_rewrite</code> has a condition named <code>HTTPS</code> built in, its result is true only if the request actually reached the box via SSL – which, thanks to our SSL offloading, will never be the case. Therefore, you need to check the environment variable of the same name instead:</p>

<p>Does <em>not</em> work:</p>

<pre><code>RewriteCond %{HTTPS} on
</code></pre>

<p>Works:</p>

<pre><code>RewriteCond %{ENV:HTTPS} on
</code></pre>

<p>We recommend you cover all bases by checking both condititions:</p>

<pre><code>RewriteCond %{HTTPS} on [OR]
RewriteCond %{ENV:HTTPS} on
</code></pre>

          </div>
        </div>
      </div>
      
    </div>
  </div>

</body>
</html>
